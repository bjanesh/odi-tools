

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Full Calibrate &mdash; odi-tools 0.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="odi-tools 0.0.1 documentation" href="index.html"/>
        <link rel="up" title="Modules" href="modules.html"/>
        <link rel="next" title="Full Phot" href="full_phot.html"/>
        <link rel="prev" title="Find sources for OTA scaling" href="ota_sourcefind.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> odi-tools
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_qr.html">QuickReduce, ODI-PPA, and odi-tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="example/index.html">An Introduction to working with Quick Reduced Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_usage.html">Basic usage</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="odi_cfgparse.html">Reading configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="odi_helpers.html">ODI helper functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="rand_bkg.html">Calculating background statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="offlinecats.html">Source catalogs</a></li>
<li class="toctree-l2"><a class="reference internal" href="getfwhm.html">Measuring Stellar FWHM</a></li>
<li class="toctree-l2"><a class="reference internal" href="mask_ota.html">Creating an OTA bad pixel mask</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_gaps.html">Create OTA gaps bad pixel masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="fixwcs.html">Improving WCS solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="ota_sourcefind.html">Find sources for OTA scaling</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Full Calibrate</a></li>
<li class="toctree-l2"><a class="reference internal" href="full_phot.html">Full Phot</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">odi-tools</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="modules.html">Modules</a> &raquo;</li>
      
    <li>Full Calibrate</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/full_calibrate.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-full_calibrate">
<span id="full-calibrate"></span><h1>Full Calibrate<a class="headerlink" href="#module-full_calibrate" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="full_calibrate.tpv_remove">
<code class="descclassname">full_calibrate.</code><code class="descname">tpv_remove</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/full_calibrate.html#tpv_remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#full_calibrate.tpv_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the TPV values from a final stacked image. Each OTA has a set of TPV
header keywords that define the WCS solution. The way the final images are
stacked, the TPV values from the last OTA in the list, OTA22 for example,
are what are inherited by the final image. Without removing these values
other Python scripts, and other program such as Source Extractor, will no
be able to accurately convert an x,y position to Ra and Dec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>str</em>) &#8211; String containing name of the image currently in use.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>img</strong> &#8211; Name of the new image produced by this function.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="s1">&#39;GCPair-F1_odi_g.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_img</span> <span class="o">=</span> <span class="n">tpv_remove</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">new_img</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;GCPair-F1_odi_g-nopv.fits&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="full_calibrate.trim_img">
<code class="descclassname">full_calibrate.</code><code class="descname">trim_img</code><span class="sig-paren">(</span><em>img</em>, <em>x1</em>, <em>x2</em>, <em>y1</em>, <em>y2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/full_calibrate.html#trim_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#full_calibrate.trim_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim a stacked image based on the coordinates given. The image is trimmed
using <code class="docutils literal"><span class="pre">imcopy</span></code> through pyraf, so the x and y pixel ranges should be given
in the correct <code class="docutils literal"><span class="pre">imcopy</span></code> format. <code class="docutils literal"><span class="pre">[x1:x2,y1:y2]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>str</em>) &#8211; String containing name of the image currently in use</li>
<li><strong>x1</strong> (<em>int</em>) &#8211; Pixel coordinate of x1</li>
<li><strong>x2</strong> (<em>int</em>) &#8211; Pixel coordinate of x2</li>
<li><strong>y1</strong> (<em>int</em>) &#8211; Pixel coordinate of y1</li>
<li><strong>y2</strong> (<em>int</em>) &#8211; Pixel coordinate of y2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>img</strong> &#8211; The new image is given the extension <code class="docutils literal"><span class="pre">.trim.fits</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="full_calibrate.full_sdssmatch">
<code class="descclassname">full_calibrate.</code><code class="descname">full_sdssmatch</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>inst</em>, <em>gmaglim=19</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/full_calibrate.html#full_sdssmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#full_calibrate.full_sdssmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>This function requires two stacked images, one each filter that will be used
in solving the color equations. The purpose of this function is to first
collect all of the SDSS sources in a given field using the
<code class="docutils literal"><span class="pre">odi.sdss_coords_full</span></code> function. After collecting a catalog of the SDSS
sources in each image this function creates a catalog of the SDSS matches
between the two fields. This is required to form the SDSS color that will be
used in solving the color equations. The function returns a <code class="docutils literal"><span class="pre">Pandas</span></code>
dataframe of the matched sources in each field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img1</strong> (<em>str</em>) &#8211; Name of the stacked image in the first filter (e.g. odi_g)</li>
<li><strong>img2</strong> (<em>str</em>) &#8211; Name of the stacked image in the second filter (e.g. odi_r)</li>
<li><strong>inst</strong> (<em>str</em>) &#8211; The version of ODI used to collect the data (podi or 5odi)</li>
<li><strong>gmaglim</strong> (<em>float</em>) &#8211; The g magnitude limit to set on the SDSS sources retrieved
in each field.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>img1_match_df</strong> (<em>pandas dataframe</em>) &#8211; Pandas dataframe of matched sources in img 1</li>
<li><strong>img2_match_df</strong> (<em>pandas dataframe</em>) &#8211; Pandas dataframe of matched sources in img 2</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="s1">&#39;GCPair-F1_odi_g.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="s1">&#39;GCPair-F1_odi_r.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inst</span> <span class="o">=</span> <span class="s1">&#39;podi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img1_match_df</span><span class="p">,</span> <span class="n">img2_match_df</span> <span class="o">=</span> <span class="n">full_sdssmatch</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span><span class="n">img2</span><span class="p">,</span><span class="n">inst</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="full_calibrate.read_proc">
<code class="descclassname">full_calibrate.</code><code class="descname">read_proc</code><span class="sig-paren">(</span><em>file</em>, <em>filter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/full_calibrate.html#read_proc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#full_calibrate.read_proc" title="Permalink to this definition">¶</a></dt>
<dd><p>This functions reads and collects information from the <code class="docutils literal"><span class="pre">derived_props.txt</span></code>
file that is produced by <code class="docutils literal"><span class="pre">odi_process.py</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>file</strong> (<em>str</em>) &#8211; This can be anything, but most often will be <code class="docutils literal"><span class="pre">derived_props.txt</span></code></li>
<li><strong>filter</strong> (<em>str</em>) &#8211; ODI filter string</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>median_fwhm</strong> (<em>float</em>) &#8211; median fwhm measure of individual OTAs that went into a stack</li>
<li><strong>median_bg_mean</strong> (<em>float</em>) &#8211; mean fwhm measure of individual OTAs that went into a stack</li>
<li><strong>median_bg_median</strong> (<em>float</em>) &#8211; median background of individual OTAs that went into a stack</li>
<li><strong>median_bg_std</strong> (<em>float</em>) &#8211; median standard deviation of background in individual OTAs
that went into a stack</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The fwhm values need to be remeasured in the final stack. There is an
additional function that completes this task.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="full_calibrate.sdss_phot_full">
<code class="descclassname">full_calibrate.</code><code class="descname">sdss_phot_full</code><span class="sig-paren">(</span><em>img</em>, <em>fwhm</em>, <em>airmass</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/full_calibrate.html#sdss_phot_full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#full_calibrate.sdss_phot_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Run <code class="docutils literal"><span class="pre">pyraf</span> <span class="pre">phot</span></code> on SDSS sources in the field. <code class="docutils literal"><span class="pre">phot</span></code> is given the
following parameters</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iraf</span><span class="o">.</span><span class="n">unlearn</span><span class="p">(</span><span class="n">iraf</span><span class="o">.</span><span class="n">phot</span><span class="p">,</span><span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="p">,</span><span class="n">iraf</span><span class="o">.</span><span class="n">photpars</span><span class="p">,</span><span class="n">iraf</span><span class="o">.</span><span class="n">centerpars</span><span class="p">,</span><span class="n">iraf</span><span class="o">.</span><span class="n">fitskypars</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">apphot</span><span class="o">.</span><span class="n">phot</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;interactive&#39;</span><span class="p">,</span><span class="s2">&quot;no&quot;</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">apphot</span><span class="o">.</span><span class="n">phot</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;verify&#39;</span><span class="p">,</span><span class="s2">&quot;no&quot;</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;datamax&#39;</span><span class="p">,</span><span class="mf">50000.</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;gain&#39;</span><span class="p">,</span><span class="s2">&quot;gain&quot;</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;ccdread&#39;</span><span class="p">,</span><span class="s1">&#39;rdnoise&#39;</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span><span class="s2">&quot;exptime&quot;</span><span class="p">)</span>

<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;filter&#39;</span><span class="p">,</span><span class="s2">&quot;filter&quot;</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;obstime&#39;</span><span class="p">,</span><span class="s2">&quot;time-obs&quot;</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="s2">&quot;INDEF&quot;</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">photpars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;zmag&#39;</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">centerpars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;cbox&#39;</span><span class="p">,</span><span class="mf">9.</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">centerpars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;maxshift&#39;</span><span class="p">,</span><span class="mf">3.</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">fitskypars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;salgorithm&#39;</span><span class="p">,</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">fitskypars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;dannulus&#39;</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;xairmass&#39;</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">airmass</span><span class="p">))</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">datapars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;fwhmpsf&#39;</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">fwhm</span><span class="p">))</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">photpars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;apertures&#39;</span><span class="p">,</span><span class="mf">5.</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">fwhm</span><span class="p">))</span> <span class="c1"># use a big aperture for this</span>
<span class="n">iraf</span><span class="o">.</span><span class="n">fitskypars</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s1">&#39;annulus&#39;</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">fwhm</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>str</em>) &#8211; String containing name of the image currently in use</li>
<li><strong>fwhm</strong> (<em>float</em>) &#8211; A measure of the fwhm of stars in the stacked image</li>
<li><strong>airmass</strong> (<em>float</em>) &#8211; Airmass assigned to the stacked image. Should match the image in the
dither that was used as the reference scaling image.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="full_calibrate.getfwhm_full_sdss">
<code class="descclassname">full_calibrate.</code><code class="descname">getfwhm_full_sdss</code><span class="sig-paren">(</span><em>img</em>, <em>radius=4.0</em>, <em>buff=7.0</em>, <em>width=5.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/full_calibrate.html#getfwhm_full_sdss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#full_calibrate.getfwhm_full_sdss" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a fwhm estimate for the image using the SDSS catalog stars and <code class="docutils literal"><span class="pre">pyraf</span>
<span class="pre">imexam</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>str</em>) &#8211; String containing name of the image currently in use</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>peak</strong> (<em>array</em>) &#8211; array of the peak counts in each SDSS source</li>
<li><strong>gfwhm</strong> (<em>array</em>) &#8211; array of the Gaussian fwhm of each SDSS source</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">peak</span></code> and <code class="docutils literal"><span class="pre">gfwhm</span></code> arrays returned by this function are used by
other functions in the <code class="docutils literal"><span class="pre">full_calibrate.py</span></code> module.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="full_calibrate.apcor_sdss">
<code class="descclassname">full_calibrate.</code><code class="descname">apcor_sdss</code><span class="sig-paren">(</span><em>img</em>, <em>fwhm</em>, <em>inspect=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/full_calibrate.html#apcor_sdss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#full_calibrate.apcor_sdss" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the aperture correction based on the photometry of SDSS sources in
the field. Each SDSS source is <code class="docutils literal"><span class="pre">phot-ed</span></code> with a range of apertures that
are multiples of the mean <code class="docutils literal"><span class="pre">fwhm</span></code> of SDSS stars in the field. Specifically,
<code class="docutils literal"><span class="pre">phot</span></code> is done using <code class="docutils literal"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">7*fwhm</span></code> in steps of <code class="docutils literal"><span class="pre">0.5</span></code>. This function
calculates the difference in the instrumental magnitude in aperture &#8216;n&#8217;
with aperture <code class="docutils literal"><span class="pre">n-1</span></code>. The aperture at which this difference levels off is
where we determine what the aperture correction is. This is typically around
<code class="docutils literal"><span class="pre">4.5</span> <span class="pre">to</span> <span class="pre">5*fwhm</span></code>, but can vary depending on the data. This difference
between this leveling off point, and the magnitude measured using <code class="docutils literal"><span class="pre">1*fwhm</span></code>
is the returned aperture correction. Sigma clipping is used to throw out
values that would throw off the measurement.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>str</em>) &#8211; String containing name of the image currently in us</li>
<li><strong>fhwm</strong> (<em>float</em>) &#8211; average of median fwhm of SDSS sources in the field</li>
<li><strong>inspect</strong> (<em>boolean</em>) &#8211; if <code class="docutils literal"><span class="pre">True</span></code> each candidate aperture correction star will be
displayed. This gives you the chance to throw out stars that
have near neighbors or next to image artifacts.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>apcor</strong> (<em>float</em>) &#8211; mean aperture correction of candidate starts remaining After
sigma clipping</li>
<li><strong>apcor_std</strong> (<em>float</em>) &#8211; standard deviation of aperture corrections of candidate starts
remaining After sigma clipping</li>
<li><strong>apcor_sem</strong> (<em>float</em>) &#8211; standard error on the mean of the aperture corrections of
candidate starts remaining After sigma clipping</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="full_calibrate.calibrate_match">
<code class="descclassname">full_calibrate.</code><code class="descname">calibrate_match</code><span class="sig-paren">(</span><em>img1</em>, <em>img2</em>, <em>fwhm1</em>, <em>fwhm2</em>, <em>airmass1</em>, <em>airmass2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/full_calibrate.html#calibrate_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#full_calibrate.calibrate_match" title="Permalink to this definition">¶</a></dt>
<dd><p>This function solves the color equations to determine the coefficients
needed to produce calibrated magnitudes. We are implementing a method
that requires have at least two filters, and their equations are solved
simultaneously. For example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">-</span><span class="n">r</span> <span class="o">=</span> <span class="n">mu_gi</span> <span class="p">(</span> <span class="n">r0</span> <span class="o">-</span> <span class="n">r0</span> <span class="p">)</span> <span class="o">+</span> <span class="n">ZP_gr</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">+</span> <span class="n">eps_gr</span> <span class="p">(</span> <span class="n">g</span> <span class="o">-</span> <span class="n">r</span> <span class="p">)</span> <span class="o">+</span> <span class="n">ZP_r</span>
<span class="n">g0</span> <span class="o">=</span> <span class="n">g_i</span> <span class="o">-</span> <span class="n">k_g</span> <span class="o">*</span> <span class="n">X_g</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">i_i</span> <span class="o">-</span> <span class="n">k_r</span> <span class="o">*</span> <span class="n">X_r</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">gi:</span></code> instrumental g magnitude</p>
<p><code class="docutils literal"><span class="pre">ri:</span></code> instrumental r magnitude</p>
<p><code class="docutils literal"><span class="pre">g:</span></code> catalog SDSS g magnitude</p>
<p><code class="docutils literal"><span class="pre">r:</span></code> catalog SDSS r magnitude</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img1</strong> (<em>str</em>) &#8211; Name of the stacked image in the first filter (e.g. odi_g)</li>
<li><strong>img2</strong> (<em>str</em>) &#8211; Name of the stacked image in the second filter (e.g. odi_r)</li>
<li><strong>fwhm1</strong> (<em>float</em>) &#8211; fwhm measure in img1</li>
<li><strong>fwhm2</strong> (<em>float</em>) &#8211; fwhm measure in img2</li>
<li><strong>arimass1</strong> (<em>float</em>) &#8211; arimass in img1</li>
<li><strong>arimass2</strong> (<em>float</em>) &#8211; arimass in img2</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img1</span> <span class="o">=</span> <span class="s1">&#39;GCPair-F1_odi_g.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="s1">&#39;GCPair-F1_odi_r.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fwhm1</span> <span class="o">=</span> <span class="mf">9.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fwhm2</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airmass1</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airmass2</span> <span class="o">=</span> <span class="mf">1.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calibrate_match</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">fwhm1</span><span class="p">,</span> <span class="n">fwhm2</span><span class="p">,</span> <span class="n">airmass1</span><span class="p">,</span> <span class="n">airmass2</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function will produce a file that contains the derived coefficients
as well as other useful calibration information. The name of this file is
automatically generated by the name of the images and given the extension
<code class="docutils literal"><span class="pre">_help.txt</span></code>.</p>
</div>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="full_phot.html" class="btn btn-neutral float-right" title="Full Phot" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ota_sourcefind.html" class="btn btn-neutral" title="Find sources for OTA scaling" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Owen Boberg, Bill Janesh.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>